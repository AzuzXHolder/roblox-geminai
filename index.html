<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Gemini API Proxy</title>
</head>
<body>
  <div id="result">Loading...</div>
  
  <script>
    // Replace with your Gemini API key
    const GEMINI_API_KEY = 'AIzaSyAFRqJdn1TEIvKT3Dj4StbDCgAiJUpC28I';
    
    async function queryGemini(prompt) {
      const body = {
        contents: [{
          parts: [{ text: prompt }]
        }]
      };
      
      try {
        const res = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(body)
          }
        );
        
        const data = await res.json();
        return {
          prompt: prompt,
          response: data?.candidates?.[0]?.content?.parts?.[0]?.text || "No response."
        };
      } catch (error) {
        return {
          prompt: prompt,
          error: error.message
        };
      }
    }
    
    // Main function
    async function main() {
      // Get query params
      const params = new URLSearchParams(window.location.search);
      const prompt = params.get("prompt");
      
      // Set content type header
      document.contentType = 'application/json';
      
      let result;
      if (prompt) {
        result = await queryGemini(prompt);
      } else {
        result = {
          error: "Missing prompt parameter",
          usage: "Add ?prompt=YourQuestion to the URL"
        };
      }
      
      // Return raw JSON only
      document.body.innerHTML = '';
      document.write(JSON.stringify(result));
    }
    
    // Run main function
    main();
  </script>
</body>
</html>
