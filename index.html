<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Gemini API Proxy</title>
</head>
<body>
  <div id="result">Processing request...</div>

  <script>
    // Get the prompt from URL parameters
    const urlParams = new URLSearchParams(window.location.search);
    const prompt = urlParams.get('prompt');
    const resultDiv = document.getElementById('result');
    
    // Define the function to query Gemini API
    async function queryGemini(promptText) {
      const GEMINI_API_KEY = 'AIzaSyAFRqJdn1TEIvKT3Dj4StbDCgAiJUpC28I';
      
      const body = {
        contents: [{
          parts: [{ text: promptText }]
        }]
      };
      
      try {
        const response = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(body)
          }
        );
        
        const data = await response.json();
        return {
          prompt: promptText,
          response: data?.candidates?.[0]?.content?.parts?.[0]?.text || "No response."
        };
      } catch (error) {
        return {
          prompt: promptText,
          error: error.message
        };
      }
    }
    
    // Function to display JSON only
    function displayJsonOnly(jsonData) {
      // Convert the entire page to just JSON
      document.body.innerHTML = '';
      document.body.style.fontFamily = 'monospace';
      document.body.style.whiteSpace = 'pre';
      document.body.textContent = JSON.stringify(jsonData);
    }
    
    // Process the prompt
    if (prompt) {
      queryGemini(prompt)
        .then(result => {
          displayJsonOnly(result);
        })
        .catch(error => {
          displayJsonOnly({
            prompt: prompt,
            error: error.message
          });
        });
    } else {
      displayJsonOnly({
        error: "Missing prompt parameter",
        usage: "Add ?prompt=YourQuestion to the URL"
      });
    }
  </script>
</body>
</html>
