<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Gemini API Proxy</title>
  <script>
    // Replace with your Gemini API key
    const GEMINI_API_KEY = 'AIzaSyAFRqJdn1TEIvKT3Dj4StbDCgAiJUpC28I';
    
    async function queryGemini(prompt) {
      const body = {
        contents: [{
          parts: [{ text: prompt }]
        }]
      };
      
      try {
        const res = await fetch(
          `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${GEMINI_API_KEY}`,
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json'
            },
            body: JSON.stringify(body)
          }
        );
        
        const data = await res.json();
        return {
          prompt: prompt,
          response: data?.candidates?.[0]?.content?.parts?.[0]?.text ?? "No response."
        };
      } catch (error) {
        return {
          prompt: prompt,
          error: error.message
        };
      }
    }
    
    window.onload = async () => {
      const params = new URLSearchParams(window.location.search);
      const prompt = params.get("prompt");
      
      // Set proper JSON content type header
      document.querySelector('head').innerHTML += '<meta http-equiv="Content-Type" content="application/json; charset=utf-8">';
      
      if (prompt) {
        const result = await queryGemini(prompt);
        
        // Return as proper JSON
        document.querySelector('html').innerHTML = '';
        document.querySelector('html').textContent = JSON.stringify(result, null, 2);
      } else {
        // Return usage instructions as JSON
        document.querySelector('html').innerHTML = '';
        document.querySelector('html').textContent = JSON.stringify({
          error: "Missing prompt parameter",
          usage: "Add ?prompt=YourQuestion to the URL"
        }, null, 2);
      }
    };
  </script>
</head>
<body>
</body>
</html>
